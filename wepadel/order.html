<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CaféMisu × We Padel – Commander</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">

<style>
    body {
        background-color: #F9F5F1;
        font-family: 'Playfair Display', serif;
        color: #A87555;
        margin: 0;
        padding: 0 20px 200px;
        line-height: 1.65;
    }

    h1 {
        text-align: center;
        margin-top: 38px;
        font-size: 2.4rem;
        font-weight: 700;
    }

    h2 {
        font-size: 1.7rem;
        margin-top: 35px;
        margin-bottom: 10px;
        border-bottom: 2px solid #A87555;
        display: inline-block;
        padding-bottom: 5px;
    }

    .item {
        background: white;
        padding: 16px;
        margin: 14px 0;
        border-radius: 12px;
        box-shadow: 0px 4px 10px rgba(0,0,0,0.07);
    }

    .item-title {
        font-size: 1.3rem;
        margin: 0 0 6px;
        font-weight: 600;
    }

    .item-price {
        font-size: 1.2rem;
        margin-bottom: 10px;
    }

    button.add {
        background-color: #A87555;
        color: white;
        border: none;
        padding: 10px 18px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
    }

    #cart {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: #A87555;
        color: white;
        padding: 18px 22px;
        font-size: 1.2rem;
        font-weight: 600;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    #cart button {
        background: white;
        color: #A87555;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1.1rem;
    }

    #checkout {
        display: none;
        padding: 20px;
        background: white;
        border-radius: 12px;
        margin-top: 30px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    input {
        width: 100%;
        padding: 12px;
        margin: 10px 0 22px;
        border: 1px solid #d7c7bd;
        border-radius: 8px;
        font-size: 1rem;
    }

    #confirm-btn {
        width: 100%;
        background-color: #A87555;
        color: white;
        padding: 14px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 1.2rem;
        margin-top: 12px;
    }
</style>
</head>

<body>

<h1>CaféMisu × We Padel</h1>

<div id="menu"></div>

<div id="cart">
    <span id="cart-count">0 article</span>
    <button onclick="openCheckout()">Valider</button>
</div>

<div id="checkout">
    <h2>Finaliser votre commande</h2>

    <label>Numéro de table *</label>
    <input type="number" id="table-number" placeholder="Ex: 7" required>

    <label>Nom (optionnel)</label>
    <input type="text" id="client-name" placeholder="Votre nom">

    <button id="confirm-btn" onclick="sendOrder()">Envoyer la commande</button>
</div>

<script type="module">
    // ---------------------------------------
    // 1. CONFIGURATION FIREBASE
    // ---------------------------------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDb7QI70lVF5vhQahUau5z2E7QOvdte9Y",
      authDomain: "cafemisu-wepadel.firebaseapp.com",
      projectId: "cafemisu-wepadel",
      storageBucket: "cafemisu-wepadel.appspot.com",
      messagingSenderId: "184586399626",
      appId: "1:184586399626:web:382a3671ca9b32baba4273"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ---------------------------------------
    // 2. MENU COMPLET CAFÉMISU
    // ---------------------------------------
    const menuItems = [

        // --- Les frappés ---
        { category: "Les frappés", name: "Latté Frappé", price: 4500 },
        { category: "Les frappés", name: "Matcha Frappé", price: 5500 },
        { category: "Les frappés", name: "Caramel Frappé", price: 5500 },
        { category: "Les frappés", name: "Lait végétal", price: 1000 },

        // --- Les matchas ---
        { category: "Les matchas", name: "Iced Matcha Latte", price: 5500 },
        { category: "Les matchas", name: "Coconut Matcha Cloud", price: 5500 },
        { category: "Les matchas", name: "Strawberry Matcha", price: 6500 },
        { category: "Les matchas", name: "Mango Matcha", price: 6500 },
        { category: "Les matchas", name: "Lait végétal", price: 1000 },

        // --- Les lattés ---
        { category: "Les lattés", name: "Iced Americano", price: 4000 },
        { category: "Les lattés", name: "Spanish Iced Latte", price: 5500 },
        { category: "Les lattés", name: "Iced Coffee Latte", price: 4500 },
        { category: "Les lattés", name: "Lait végétal", price: 1000 },

        // --- Boissons chaudes ---
        { category: "Boissons chaudes", name: "Café au lait", price: 3500 },
        { category: "Boissons chaudes", name: "Thé", price: 1500 },
        { category: "Boissons chaudes", name: "Chocolat chaud", price: 3500 },
        { category: "Boissons chaudes", name: "Espresso", price: 1000 },
        { category: "Boissons chaudes", name: "Americano", price: 2000 },
        { category: "Boissons chaudes", name: "Cappuccino", price: 3500 },
        { category: "Boissons chaudes", name: "Lait végétal", price: 1000 },

        // --- Les spéciaux ---
        { category: "Les spéciaux", name: "Caramel Machiatto", price: 5000 },
        { category: "Les spéciaux", name: "Iced Chocolate", price: 5000 },
        { category: "Les spéciaux", name: "UBE Latte", price: 7000 },
        { category: "Les spéciaux", name: "Lait végétal", price: 1000 },

        // --- Boissons gazeuses ---
        { category: "Boissons gazeuses", name: "Coca", price: 1000 },
        { category: "Boissons gazeuses", name: "Sprite", price: 1000 },
        { category: "Boissons gazeuses", name: "Fanta", price: 1000 },
        { category: "Boissons gazeuses", name: "Ice Tea", price: 1000 },
        { category: "Boissons gazeuses", name: "Cody’s", price: 1000 },
        { category: "Boissons gazeuses", name: "Redbull", price: 2000 },
        { category: "Boissons gazeuses", name: "Perrier", price: 2000 },
        { category: "Boissons gazeuses", name: "Eau", price: 1000 },

        // --- Spéciaux du weekend ---
        { category: "Spéciaux du weekend", name: "Tiramisu Cake Latte", price: 7000 },
        { category: "Spéciaux du weekend", name: "Tiramisu Cake Matcha Latte", price: 7500 },
        { category: "Spéciaux du weekend", name: "Matcha Banana Pudding", price: 7500 },
        { category: "Spéciaux du weekend", name: "LE LATTE XXXL", price: 25000 },
        { category: "Spéciaux du weekend", name: "LE MATCHA XXXL", price: 30000 },
        { category: "Spéciaux du weekend", name: "Lait végétal", price: 1000 },

        // --- Tiramisu ---
        { category: "Tiramisu", name: "Tiramisu Café", price: 4000 },
        { category: "Tiramisu", name: "Tiramisu Matcha", price: 5000 },
        { category: "Tiramisu", name: "Tiramisu Nutella", price: 5000 },
        { category: "Tiramisu", name: "Tiramisu Fraise", price: 5500 },
        { category: "Tiramisu", name: "Tiramisu Spéculos", price: 5500 },
        { category: "Tiramisu", name: "Tiramisu Ferrero", price: 5500 },
        { category: "Tiramisu", name: "Tiramisu Bueno", price: 5500 },
        { category: "Tiramisu", name: "Tiramisu Pistache", price: 5500 },
        { category: "Tiramisu", name: "Tiramisu Oreo", price: 5000 }
    ];

    const menuDiv = document.getElementById("menu");
    let cart = [];

    // ---------------------------------------
    // 3. Affichage dynamique du menu
    // ---------------------------------------
    function renderMenu() {
        let currentCategory = "";
        menuItems.forEach((item, index) => {

            if (item.category !== currentCategory) {
                currentCategory = item.category;
                menuDiv.innerHTML += `
                    <h2>${currentCategory}</h2>
                `;
            }

            menuDiv.innerHTML += `
                <div class="item">
                    <div class="item-title">${item.name}</div>
                    <div class="item-price">${item.price.toLocaleString()} FCFA</div>
                    <button class="add" onclick="addToCart(${index})">Ajouter</button>
                </div>
            `;
        });
    }
    renderMenu();

    window.addToCart = function(index) {
        cart.push(menuItems[index]);
        document.getElementById("cart-count").textContent = cart.length + " article(s)";
    };

    window.openCheckout = function() {
        document.getElementById("checkout").style.display = "block";
        window.scrollTo(0, document.body.scrollHeight);
    };

    // ---------------------------------------
    // 4. ENVOI DE LA COMMANDE
    // ---------------------------------------
    window.sendOrder = async function() {
        const table = document.getElementById("table-number").value;

        if (!table) {
            alert("Veuillez entrer votre numéro de table.");
            return;
        }

        await addDoc(collection(db, "orders"), {
            items: cart,
            table: table,
            name: document.getElementById("client-name").value || "—",
            status: "pending",
            createdAt: serverTimestamp()
        });

        alert("Votre commande a été envoyée !");
        window.location.href = "/"; 
    };
</script>

</body>
</html>
